for folder in $HDFS_FOLDERS; do
    folder_name=$(basename "$folder")  # Extract folder name
    echo "üì• Moving HDFS folder $folder to Local: $LOCAL_PARENT_DIR"

    hdfs dfs -get "$folder" "$LOCAL_PARENT_DIR"

    # Check if copy was successful
    if [ $? -eq 0 ]; then
      echo "‚úÖ Folder $folder_name copied successfully to $LOCAL_PARENT_DIR"

      # Step 4: SCP transfer after copying
      echo "üöÄ Transferring $folder_name to remote server..."
      
      sshpass -p "$PASSWORD" scp -r "$LOCAL_PARENT_DIR/$folder_name" user@remote-server:"$TARGET_PATH"

      # Check if SCP command was successful
      if [ $? -eq 0 ]; then
        echo "‚úÖ $folder_name transferred successfully to $TARGET_PATH"
      else
        echo "‚ùå SCP failed for $folder_name"
      fi
    else
      echo "‚ùå Failed to copy $folder_name from HDFS!"
    fi  # <-- Correctly closing the if statement
done  # <-- Closing the for loop
