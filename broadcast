#!/bin/bash

# Define HDFS parent path where folders are located
HDFS_PARENT_DIR="/tmp/venkat"

# Define Local directory where folders should be copied
LOCAL_PARENT_DIR="/disk1/ramp/output"

# Define Remote Server details for SCP transfer
REMOTE_USER="user"
REMOTE_HOST="remote-server"
TARGET_PATH="/etl/inbound"
PASSWORD="your_password"

# Find all HDFS folders matching the pattern "rbs"
HDFS_FOLDERS=$(hdfs dfs -ls "$HDFS_PARENT_DIR" | awk '{print $NF}' | grep "rbs")

# Loop through each folder found
for folder in $HDFS_FOLDERS; do
    folder_name=$(basename "$folder")  # Extract folder name
    echo "ðŸ“¥ Moving HDFS folder $folder to Local: $LOCAL_PARENT_DIR"

    # Copy the entire folder from HDFS to local
   
