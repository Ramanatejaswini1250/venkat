val insertStatement = pconn.prepareStatement(insertQuery)
insertStatement.setString(1, row.getAs[String]("alert_code"))
insertStatement.addBatch()
insertStatement.executeBatch() // Execute batch instead of executeUpdate()

// Fetch the last inserted Job_Id
val jobIdQuery = "SELECT MAX(Job_Id) FROM U_D_DSV_001_RIS_1.Ramp_Control_BAU_Jobs_Info"
val resultSet = stmt.executeQuery(jobIdQuery)
var jobId = ""
if (resultSet.next()) {
    jobId = resultSet.getString(1) // Fetch latest Job_Id
}

val jobEndTime = new Timestamp(System.currentTimeMillis())
