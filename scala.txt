val MasterTable2DF = new ListBuffer[String]()

while (masterTable2_format.next()) {
    // Safely extract column values, replacing nulls with an empty string
    val col1 = Option(masterTable2_format.getString(1)).getOrElse("")
    val col2 = Option(masterTable2_format.getString(2)).getOrElse("")
    val col3 = Option(masterTable2_format.getString(3)).getOrElse("")
    val col4 = Option(masterTable2_format.getString(4)).getOrElse("")

    val Master2transformedRow = 
        s"$col1,$col2,${if (col3.contains(".")) "\"" + col3 + "\"" else col3},$col4"

    MasterTable2DF += Master2transformedRow
}
