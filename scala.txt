// Assuming you're using Scala and Spark
import org.apache.spark.sql.types._
import org.apache.spark.sql.Row

// Example schema
val schema = StructType(Seq(
  StructField("ALERT_ID", StringType, true),
  StructField("PRIORITY", StringType, true),
  StructField("SEQUENCENUMBER", StringType, true),
  StructField("MESSAGE", StringType, true)
))

// Debug SQL query result
val resultSet = stmt.executeQuery("YOUR SQL QUERY")
val rows = scala.collection.mutable.ArrayBuffer[Row]()

while (resultSet.next()) {
  val alertId = resultSet.getString("ALERT_ID")
  val priority = resultSet.getString("PRIORITY")
  val sequenceNumber = resultSet.getString("SEQUENCENUMBER")
  val message = resultSet.getString("MESSAGE")
  rows.append(Row(alertId, priority, sequenceNumber, message))
}

// Debug print rows
rows.foreach(println)

// Create DataFrame
val rdd = spark.sparkContext.parallelize(rows)
val df = spark.createDataFrame(rdd, schema)

// Write to HDFS
df.write.mode("overwrite").csv("hdfs://path/to/output")
