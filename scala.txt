import scala.collection.JavaConverters._

// Get the value from businessContactsMap
businessContactsMap.get(alertCode) match {
  case Some((business, rawEmailArray: Any, frequency: String)) if frequencyFilter.contains(frequency) =>

  val emailArray: Array[String] = rawEmailArray match {
      case str: String => Array(str) // Convert single String to Array[String]
      case list: java.util.List[_] => list.asScala.collect { case s: String => s }.toArray // Convert Java List to Array[String]
      case arr: Array[_] => arr.collect { case s: String => s } // Convert any array to Array[String]
      case _ => Array.empty[String] // Handle unexpected types
    }


    // Convert Array to comma-separated string
    val emailAddress = emailArray.mkString(",")

    // Debugging: Print final emailAddress
    println(s"DEBUG: Final emailAddress = $emailAddress")
}
