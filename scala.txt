import scala.collection.JavaConverters._

businessContactsMap.get(alertCode) match {
  case Some((business, rawEmailArray: Any, frequency: String)) if frequencyFilter.contains(frequency) =>
    
    val emailArray: Array[String] = rawEmailArray match {
      case arr: Array[_] =>
        arr.collect { case s: String => s } // Collect only Strings from Array

      case list if list.isInstanceOf[java.util.List[_]] =>
        list.asInstanceOf[java.util.List[_]].asScala.collect { case s: String => s }.toArray
        // Explicit conversion of Java List to Scala List before collecting Strings

      case str: String =>
        Array(str) // Convert single String to Array

      case _ =>
        Array.empty[String] // Handle unexpected cases gracefully
    }

    val emailAddress = emailArray.mkString(",") // Convert to comma-separated String
}
