val expectedAlertId = MasterTable2DF.headOption.map(_("alert_id")).getOrElse("")


val headerColumns = master2_read_header.split(",")  // Assuming CSV is comma-separated
val alertIdIndex = headerColumns.indexOf("alert_id") // Find index of 'alert_id'

val expectedAlertId = masterTable2DF.select("alert_id").first().getString(0)


if (alertIdIndex == -1) {
    println("ERROR: 'alert_id' column not found in Master2 file!")
} else {
    println(s"'alert_id' found at index: $alertIdIndex")
}

var line2 = Master2_br.readLine()
while (line2 != null) {
    val rowValues = line2.split(",") // Split row into columns
    if (alertIdIndex < rowValues.length) {
        val alertIdValue = rowValues(alertIdIndex).trim // Get alert_id value
        if (alertIdValue == expectedAlertId) { // Compare with expected value
            Master2CSVrows += line2
        }
    }
    line2 = Master2_br.readLine()
}
