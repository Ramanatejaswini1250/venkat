val emailArray: Array[String] = rawEmailArray match {
      case arr: Array[String] => 
        arr // Already an Array[String], use directly

      case list: java.util.List[_] if !list.isEmpty && list.get(0).isInstanceOf[String] =>
        list.asScala.collect { case s: String => s }.toArray // Convert Java List to Scala Array
        
      case str: String => 
        Array(str) // Convert single String to Array
        
      case _ =>
        Array.empty[String] // Default case for unexpected types
    }
