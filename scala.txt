// Find 'ALERT_ID' column index dynamically
val headerColumns = MasterTable2DF.headOption.map(_.split(","))  // Get header row
val alertIdIndex = headerColumns.map(_.indexWhere(_.equalsIgnoreCase("ALERT_ID"))).getOrElse(-1)

if (alertIdIndex == -1) {
    throw new Exception("ERROR: 'ALERT_ID' column not found in MasterTable2DF!")
}

// Extract multiple ALERT_IDs from MasterTable2DF
val expectedAlertIds = MasterTable2DF.tail.map(_.split(",")(alertIdIndex).trim).toSet

// Read and compare data
while (line2 != null) {
    val rowValues = line2.split(",")
    if (alertIdIndex < rowValues.length) {
        val alertIdValue = rowValues(alertIdIndex).trim
        if (expectedAlertIds.contains(alertIdValue)) {
            Master2CSVrows += line2
        }
    }
    line2 = Master2_br.readLine()
}
