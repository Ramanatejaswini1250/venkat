def sendConsolidatedEmail(allSuccess: Seq[String], allFailures: Seq[String], currentDate: String): Unit = {
  val subject = s"Consolidated Alert Report for $currentDate"

  val message =
    s"""
      |<html>
      |<head>
      |  <style>
      |    table {
      |      width: 100%;
      |      border-collapse: collapse;
      |    }
      |    th, td {
      |      border: 1px solid black;
      |      padding: 8px;
      |      text-align: left;
      |    }
      |    th {
      |      background-color: #4CAF50;
      |      color: white;
      |    }
      |    .success {
      |      background-color: #d4edda;
      |      color: #155724;
      |    }
      |    .failure {
      |      background-color: #f8d7da;
      |      color: #721c24;
      |    }
      |  </style>
      |</head>
      |<body>
      |  <h2>Consolidated Alert Report for $currentDate</h2>
      |  <h3>Success Alerts</h3>
      |  <table>
      |    <tr>
      |      <th>Alert</th>
      |    </tr>
      |    ${allSuccess.map(alert => s"<tr class='success'><td>$alert</td></tr>").mkString("\n")}
      |  </table>
      |
      |  <h3>Failure Alerts</h3>
      |  <table>
      |    <tr>
      |      <th>Alert</th>
      |    </tr>
      |    ${allFailures.map(alert => s"<tr class='failure'><td>$alert</td></tr>").mkString("\n")}
      |  </table>
      |</body>
      |</html>
      |""".stripMargin

  EmailService.sendEmail(subject, message)
}
